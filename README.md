# Благотворительный фонд поддержки котиков QRKot

## Описание

Приложение для Благотворительного фонда поддержки котиков QRKot. Фонд собирает пожертвования на различные целевые проекты: на медицинское обслуживание нуждающихся хвостатых, на обустройство кошачьей колонии в подвале, на корм оставшимся без попечения кошкам — на любые цели, связанные с поддержкой кошачьей популяции.

## Функциональность

- **Проекты**: В Фонде QRKot может быть открыто несколько целевых проектов. У каждого проекта есть название, описание и сумма, которую планируется собрать. После того, как нужная сумма собрана — проект закрывается.
- **Пожертвования**: Пожертвования не целевые: они вносятся в фонд, а не в конкретный проект. Каждое полученное пожертвование автоматически добавляется в первый открытый проект, который ещё не набрал нужную сумму.
- **Пользователи**: Целевые проекты создаются администраторами сайта. Любой пользователь может видеть список всех проектов, включая требуемые и уже внесенные суммы. Зарегистрированные пользователи могут отправлять пожертвования и просматривать список своих пожертвований.

## Технологии

- FastAPI
- SQLAlchemy
- Alembic
- FastAPI Users
- Pydantic

## Установка и запуск

1. Клонировать репозиторий
2. Создать и активировать виртуальное окружение:
```
python -m venv venv
source venv/bin/activate  # для Linux/Mac
venv\Scripts\activate  # для Windows
```
3. Установить зависимости:
```
pip install -r requirements.txt
```
4. Создать файл .env в корне проекта со следующими переменными окружения:
```
APP_TITLE=Кошачий благотворительный фонд
APP_DESCRIPTION=Приложение для сбора средств на различные целевые проекты для помощи кошкам
DATABASE_URL=sqlite+aiosqlite:///./fastapi.db
SECRET=your_super_secret_key_for_jwt_tokens
FIRST_SUPERUSER_EMAIL=admin@example.com
FIRST_SUPERUSER_PASSWORD=admin
```

5. Запустить приложение одним из способов:

### Способ 1: Автоматический запуск (рекомендуется)
```
python app/run.py
```
Этот скрипт автоматически:
- Применит миграции, если база данных не существует
- Создаст суперпользователя, если он не существует
- Запустит приложение с помощью uvicorn

### Способ 2: Ручной запуск
```
# Применить миграции
alembic upgrade head

# Создать суперпользователя
python app/create_superuser.py

# Запустить приложение
uvicorn app.main:app --reload
```

## API Endpoints

### Документация API
- `/docs` - Swagger документация
- `/redoc` - ReDoc документация

### Пользователи
- `POST /auth/register` - Регистрация нового пользователя
- `POST /auth/jwt/login` - Получение JWT токена
- `GET /users/me` - Получение информации о текущем пользователе

### Проекты
- `GET /charity_project/` - Получение списка всех проектов
- `POST /charity_project/` - Создание нового проекта (только для суперпользователей)
- `DELETE /charity_project/{project_id}` - Удаление проекта (только для суперпользователей)
- `PATCH /charity_project/{project_id}` - Обновление проекта (только для суперпользователей)

### Пожертвования
- `GET /donation/` - Получение списка всех пожертвований (только для суперпользователей)
- `POST /donation/` - Создание нового пожертвования
- `GET /donation/my` - Получение списка своих пожертвований